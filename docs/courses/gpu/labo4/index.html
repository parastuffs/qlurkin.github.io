<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SA4L - Labo 4</title>
    <script src="/document.js"></script>
</head>
<body>
    <h1>SA4L - Labo 4</h1>
    
    <h1 id="sa4l---labo-4-simulation-sur-cpu">SA4L - Labo 4 <small>Simulation sur CPU</small></h1>
<p>Dans cette séance nous allons commencer à simuler quelques particules. Nous allons commencer par le faire sur le CPU pour bien comprendre comment ces simulations fonctionnent. Dans les séances à venir nous verrons comment les calculer sur GPU</p>
<h2 id="animer-une-particule">Animer une particule</h2>
<p>Une particule est simplement un point qui possède une position $(x, y, z)$ et une vitesse $(v_x, v_y, v_z)$. Pour l&#39;animer il suffit de mettre à jour sa position à chaque <em>frame</em>.</p>
<p>$$ \begin{array}{rcl} x &amp; = &amp; x + \Delta t \cdot v_x \ y &amp; = &amp; y + \Delta t \cdot v_y \ z &amp; = &amp; z + \Delta t \cdot v_z\end{array} $$</p>
<p>Dans <code>raylib</code>, Vous pouvez récupérer le temps écoulé depuis la dernière frame avec <code>GetFrameTime()</code>.</p>
<h3 id="exercice">Exercice</h3>
<p>Créez une classe <code>Particle</code> qui représente une particule et faites un programme qui affiche une particule se déplaçant selon sa vitesse.</p>
<h2 id="collision">Collision</h2>
<p>Lorsqu&#39;une collision est détectée, la particule est réfléchie par rapport à la normale à la surface de collision. C&#39;est donc bien la direction du vecteur vitesse de la particule qui change. Dans <code>raymath.h</code>, vous avez une fonction</p>
<pre><code class="language-cpp">Vector3 Vector3Reflect(Vector3 v, Vector3 normal);
</code></pre>
<p>qui permet de calculer le vecteur réfléchit.</p>
<p>La detection de la collision et le calcul de la normale dépendent de la surface de collision. Pour un plan d&#39;équation $ ax + by + cz + d = 0 $ le normale est $(a, b, c)$. Un tel plan sépare l&#39;espace en 2 régions: La région où l&#39;expression $ ax + by + cz + d $ est positive et celle où elle est négative. On choisit généralement la région positive comme zone autorisée pour la particule et on détecte une collision dès qu&#39;elle passe dans la région négative.</p>
<p>Une fois la collision détectée, la particule se trouve dans la &quot;zone interdite&quot;. Il généralement nécessaire de la replacer dans la zone autorisée avant de laisser la simulation continuer.</p>
<p>Il est bien sûr possible de detecter des collisions avec d&#39;autres primitives que des plans.</p>
<h3 id="exercice-1">Exercice</h3>
<p>Placer votre particule dans une boite et laissez la rebondir sur les 6 faces. Une boite peut être implémentée par 6 plans ou par <a href="https://www.iquilezles.org/www/articles/boxfunctions/boxfunctions.htm">une fonction SDF <em>(Signed Distance Field)</em> adaptée</a>.</p>
<p>Essayez d&#39;implémenter les collisions pour qu&#39;il soit facile d&#39;ajouter des surfaces de collisions <em>(évitez d&#39;hardcoder la collision dans la classe Particule)</em></p>
<figure id="cube"></figure>
<script type='module' src='exercice2.js'> </script>

<h2 id="système-de-particules">Système de particules</h2>
<p>Un système de particules gère un ensemble de particules.</p>
<h3 id="exercice-2">Exercice</h3>
<p>Ajouter une classe <code>ParticleSystem</code> qui crée un certain nombre de particules avec des positions et des vitesses aléatoires et permet de les faire rebondir dans la boite.</p>
<p>Veillez à enregistrer vos particules de façon contiguë dans la mémoire (<code>array</code> ou <code>std::vector</code>) pour maximiser l&#39;utilisation de la cache.</p>
<figure id="cube2"></figure>
<script type='module' src='exercice3.js'> </script>

<h2 id="gravité">Gravité</h2>
<p>La gravité est plus une accélération qu&#39;une force. Elle modifie directement la vitesse des particules:</p>
<p>$$ \begin{array}{rcl} v_x &amp; = &amp; v_x + \Delta t \cdot g_x \ v_y &amp; = &amp; v_y + \Delta t \cdot g_y \ v_z &amp; = &amp; v_z + \Delta t \cdot g_z\end{array} $$</p>
<h3 id="exercice-3">Exercice</h3>
<p>Modifiez vos classes <code>Particle</code> et <code>ParticleSystem</code> pour que les particules subissent la gravité.</p>
<figure id="cube3"></figure>
<script type='module' src='exercice4.js'> </script>



</body>
</html>