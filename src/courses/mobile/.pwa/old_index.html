<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Service Worker</title>
	<script src="https://quentin.lurkin.xyz/document.js" defer></script>
	<style>
		iframe {
			margin: 1rem auto;
			display: block;
		}
	</style>
</head>
<body>
	<h1><em>Service worker</em> et offline</h1>
	<p>La problématique de rendre un site disponible offline comporte deux aspects:</p>
	<ol>
		<li>Il faut que l'interface utilisateur soit disponible (HTML, CSS, Javascript)</li>
		<li>Il faut que les données soient disponibles (Database)</li>
	</ol>
	<p>Les <em>Services Worker</em> permettent de régler ces deux problèmes.</p>
	<p>Le premier problème, fournir une interface offline, est le plus facile à mettre en place. Dans bien des cas, on ne pourra pas aller plus loin. Certaines app ont besoin de données lives.</p>

	<h2>Service Worker</h2>
	<p>Un <em>service worker</em> est un script Javascript qui intercepte toutes les requêtes réseaux d'un site. Le <em>service worker</em> peut utiliser des données mise en cache pour répondre à ces requêtes ou les laisser continuer vers le réseaux. Il peut aussi choisir quelles données/HTML/CSS/Javascript seront mise en cache. Voici une vidéo sur l'implémentation d'un <em>service worker</em>:</p>
	<iframe width="560" height="315" src="https://www.youtube.com/embed/t4jh4hQ-NIk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

	<h2>Firebase</h2>
	<p>Pour permettre l'accès à certaines données lorsqu'on est offline il faut avoir mis ces données en cache au moment où on était online.</p>
	<p>On peut bien sûr utiliser le <em>Service worker</em> mais dans le cas de firebase cette fonction est déjà incluse dans le <em>Cloud Firestore</em>.</p>
	<p>Voici la documentation liée à cet aspect du Cloud Firestore:</p>
	<p><a href="https://firebase.google.com/docs/firestore/manage-data/enable-offline">https://firebase.google.com/docs/firestore/manage-data/enable-offline</a></p>
	<p>Et aussi une petite vidéo:</p>
	<iframe width="560" height="315" src="https://www.youtube.com/embed/oDvdAFP6OhQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

	<h2>manifest.webmanifest</h2>
	<ul>
		<li><a href="https://web.dev/add-manifest/">https://web.dev/add-manifest/</a></li>
		<li><a href="https://app-manifest.firebaseapp.com/">https://app-manifest.firebaseapp.com/</a></li>
	</ul>

	<h2>Ressources supplémentaires</h2>
	<ul>
		<li><a href="https://web.dev/progressive-web-apps/">https://web.dev/progressive-web-apps/</a></li>
		<li><a href="https://www.youtube.com/watch?v=Hp_dQvQyYEI">https://www.youtube.com/watch?v=Hp_dQvQyYEI</a></li>
		<li><a href="https://www.youtube.com/watch?v=psB_Pjwhbxo&list=PLNYkxOF6rcIB2xHBZ7opgc2Mv009X87Hh">https://www.youtube.com/watch?v=psB_Pjwhbxo&list=PLNYkxOF6rcIB2xHBZ7opgc2Mv009X87Hh</a></li>
	</ul>
</body>
</html>