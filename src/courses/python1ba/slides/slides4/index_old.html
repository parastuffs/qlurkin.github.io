<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IC1T - Cours 4</title>
    <script src="https://quentin.lurkin.xyz/deck.js"></script>
</head>
<body>
    <section>
        <h1>IC1T - Programmation <small>Les fonctions</small></h1>
    </section>

    <section>
        <h2>Définitions de fonctions</h2>
        <ul>
            <li>
                Nous avons déjà vu plusieurs fonctions prédéfinies :<br>
                <code>print()</code>, <code>sqrt()</code>, <code>len()</code>, <code>input()</code>, <code>int()</code>, ...
            </li>
            <li>Une fonction est une "<strong>boite noire</strong>" qui <strong>peut</strong> recevoir une ou plusieurs <strong>valeurs</strong> en arguments et <strong>peut</strong> renvoyer une valeur de <strong>sortie</strong>.</li>
            <li>Définir ses propres fonctions sert à deux choses :
                <ul>
                    <li><strong>Eviter de répéter</strong> plusieurs fois le même code.</li>
                    <li><strong>Structurer</strong> les longs programmes en les découpant en <strong>petites parties simples</strong>.</li>
                </ul>
            </li>
        </ul>
    </section>

    <section>
        <h2>Fonctions sans argument ni valeur de retour</h2>
        <ul>
            <li>Voici la <strong>définition</strong> d'une fonction qui affiche la table de 7 :
                <pre><code class="lang-python">
                    def table7():
                        n = 1
                        while n <= 10:
                            print(n, "x 7 =", n * 7)
                            n += 1
                </code></pre>
            </li>
            <li>Une fois la fonction définie, on peut l'<strong>appeler</strong> autant de fois qu'on veut :
                <pre><code class="lang-python">
                    # affichons 2 fois la table de 7
                    table7()
                    table7()
                </code></pre>
            </li>
        </ul>
        <p class="center big"><strong>Une fonction n'est exécutée que lorsqu'on l'appelle</strong></p>
    </section>

    <section>
        <h2>Fonctions sans argument ni valeur de retour</h2>
        <ul>
            <li>La fontion table7() ne retourne rien :
                <pre><code class="lang-python">
                    x = table7() # affiche la table de 7
                    print(x)     # affiche None
                </code></pre>
            </li>
            <li>Comme elle ne prend pas de paramètre, elle fait toujours <strong>la même chose</strong>.</li>
        </ul>
    </section>

    <section>
        <h2>Fonctions avec arguments</h2>
        <ul>
            <li>Les <strong>valeur(s)</strong> reçue(s) en paramètre(s) sont utilisée(s) lors de l'exécution de la fonction :</li>
        </ul>
        <pre><code class="lang-python">
            # définition de la fonction table().
            def table(base):
                n=1
                while n <= 10:
                    print(n, "x", base, "=", n * base)
                    n += 1
            
            # appels à la fonction table()
            table(3)       # affiche la table de 3
            table(base=8)  # affiche la table de 8
            a = 42
            table(a)       # affiche la table de 42
        </code></pre>
    </section>

    <section>
        <h2>Fonctions avec arguments</h2>
        <ul>
            <li>On peut aussi avoir plusieurs arguments :</li>
        </ul>
        <pre><code class="lang-python">
            # définition de la fonction table().
            def table(base, start, length):
                n = start
                while n &lt; start + length:
                    print(n, "x", base, "=", n * base)
                    n += 1
            
            # appels à la fonction table()
            table(3, 1, 10)
            table(base=8, start=5, length=2)
        </code></pre>
    </section>

    <section>
        <h2>Fonctions avec arguments</h2>
        <ul>
            <li>On peut aussi avoir des valeurs par défaut pour les arguments :</li>
        </ul>
        <pre><code class="lang-python">
            # définition de la fonction table().
            def table(base, start=1, length=10):
                n = start
                while n &lt; start + length:
                    print(n, "x", base, "=", n * base)
                    n += 1
            
            # appels à la fonction table()
            table(8, 5, 2)
            table(8)
            table(8, 5)
            table(8, length=2)
        </code></pre>
    </section>

    <section>
        <h2>Fonctions avec valeur de retour</h2>
        <ul>
            <li>Le mot-clé <strong>return</strong> permet de définir la valeur de retour :</li>
        </ul>
        <pre><code class="lang-python">
            # définition de la fonction multiply()
            def multiply(a, b):
                return a * b
            
            res = multiply(7, 9)   # appel à la fonction. N'affiche rien.
            print(res)             # affiche 63
            print(multiply(6, 7))  # affiche 42
        </code></pre>
    </section>

    <section>
        <h2>Fonctions avec valeur de retour</h2>
        <ul>
            <li>On peut utiliser une fonction dans le corps d'une autre :</li>
        </ul>
        <pre><code class="lang-python">
            # définition de multiply()
            def multiply(a, b):
                return a * b
            
            # définition de table()
            def table(base, start=1, length=10):
                n = start
                while n < start + length:
                    # utilisation de multiply()
                    print(n, "x", base, "=", multiply(n, base))
                    n += 1
            
            # appel à la fonction table()
            table(5, length=3)
        </code></pre>
    </section>

    <section>
        <h2>Fonctions avec valeur de retour</h2>
        <ul>
            <li>Lorsque le mot-clé return est rencontré, la fonction <strong>s'arrête</strong> et le programme se poursuit après l'appel.
                <small>Cela permet quelques simplifications :</small>
            </li>
        </ul>
        <pre><code class="lang-python">
            def abs(x):
                if x &lt; 0:
                    return -x
                else:
                    return x
        </code></pre>
        <pre><code class="lang-python">
            # version simplifiée
            def abs(x):
                if x &lt; 0:
                    return -x
                return x
        </code></pre>
    </section>

    <section>
        <h2>Variables locales et globales</h2>
        <ul>
            <li>Dès que l'on a des fonctions, il faut comprendre la différence entre variables locales et globales.</li>
            <li>Une variable globale est définie <strong>en dehors de toute fonction</strong>. Elle est accessible dans <strong>l'ensemble du programme</strong>.</li>
            <li>Une variable locale est définie <strong>dans une fonction</strong>. Elle est accessible uniquement <strong>dans cette fonction</strong>.</li>
        </ul>
        <pre><code class="lang-python">
            def tvac(amount):
                n = 1 + interest / 100
                return amount * n
            
            interest = 21
            n = 25
            print(tvac(n))
        </code></pre>
    </section>

    <section>
        <h2>Variables locales et globales</h2>
        <ul>
            <li>Une variable locale est inaccessible hors de la fonction où elle est définie :
                <pre><code class="lang-python">
                    def fun():
                        a = 12

                    fun()
                    print(a) # error
                </code></pre>
            </li>
            <li>Une variable globale est accessible partout :
                <pre><code class="lang-python">
                    def fun():
                        print(a)   # affiche 12
                    
                    a = 12
                    fun()
                </code></pre>
            </li>
        </ul>
    </section>

    <section>
        <h2>Variables locales et globales</h2>

        <ul>
            <li>Lorsqu'une variable locale porte le même nom qu'une globale, priorité à la locale :
                <pre><code class="lang-python">
                    def fun():
                        a = 42
                        print("dans fun :", a)     # affiche 42

                    a = 12
                    fun()
                    print("en dehors de fun :", a) # affiche 12
                </code></pre>
            </li>
            <li><strong>Même avant sa définition dans la fonction</strong> :
                <pre><code class="lang-python">
                    def fun():
                        print("globale :", a)   #error
                        a = 42

                    print("locale :", a)
                    a = 12
                    fun()
                </code></pre>
            </li>
        </ul>
    </section>

    <section>
        <h2>Variables locales et globales</h2>
        <ul>
            <li>Si on souhaite modifier une variable globale de l'intérieur d'une fonction :
                <pre><code class="lang-python">
                    def fun():
                        global a
                        a = 42

                    a = 12 
                    fun()
                    print(a)      # affiche 42
                </code></pre>
            </li>
        </ul>
        <p class="big center"><strong>Ce n'est pas une bonne pratique.</strong></p>
    </section>

    <section>
        <h2>Une fonction est une valeur</h2>
        <ul>
            <li>Une fonction peut être mise dans une variable :</li>
        </ul>
        <pre><code class="lang-python">
            def add(a, b):
                return a + b

            somme = add
            print(somme(1, 2))     # affiche 3
        </code></pre>
    </section>

    <section>
        <h2>Une fonction est une valeur</h2>
        <ul>
            <li>Une fonction peut être passée en paramètre à une fonction :</li>
        </ul>
        <pre><code class="lang-python">
            def add(a, b):
                return a + b

            def multiply(a, b):
                return a * b

            def table(base, start=1, length=10, symbol="*", op=multiply):
                n = start
                while n &lt; start + length:
                    print(n, symbol, base, "=", op(n, base))
                    n += 1
            
            table(4, length=2)
            table(4, length=2, symbol="+", op=add)
        </code></pre>
    </section>

    <section>
		<h2>Fonctions d'ordre supérieur</h2>
		<ul>
            <li>Les fonctions prenant une fonction en paramètre s'appelle des <strong>fonctions d'ordre supérieur</strong>.</li>
            <li>Il en existe pour effectuer les traitements les plus courant sur les listes</li>
			<li>
				présentons trois types de traitement courant:
				<ul>
					<li>Correspondance (<code>map</code>)</li>
					<li>Filtrage (<code>filter</code>)</li>
					<li>Réduction (<code>reduce</code>)</li>
				</ul>
			</li>
		</ul>
	</section>

    <section>
		<h2>Correspondance</h2>
		<ul>
			<li>Produire une donnée pour chaque élément d'une liste</li>
			<li>Le résultat est une liste de même taille que la liste de départ.</li>
		</ul>
		<pre><code class="lang-python">
            def square(L):
                res = []
                for elem in L:
                    res.append(elem**2)
                return res
		</code></pre>
		<ul>
			<li>Seul le contenu du <code>append()</code> est spécifique.</li>
		</ul>
	</section>

    <section>
		<h2>Fonction <code>map()</code></h2>
		<ul>
			<li>Factorisons la partie commune:</li>
		</ul>
		<pre><code class="lang-python">
            def square(x):
                return x**2

            print(list(map(square, [2, 3, 4])))
		</code></pre>
        <div class="terminal">
            [4, 9, 16]
        </div>
	</section>

    <section>
		<h2>Filtrage</h2>
		<ul>
			<li>Garder une partie des éléments de départ</li>
			<li>Le résultat est une liste plus petite que la liste de départ. <small>Elle peut aussi être de même taille</small></li>
		</ul>
		<pre><code class="lang-python">
            def even(L):
                res = []
                for elem in L:
                    if elem % 2 == 0:
                        res.append(elem)
                return res
		</code></pre>
		<ul>
			<li>Seul le test du <code>if</code> est spécifique.</li>
		</ul>
	</section>

    <section>
		<h2>Fonction <code>filter()</code></h2>
		<ul>
			<li>Factorisons la partie commune:</li>
		</ul>
		<pre><code class="lang-python">
            def even(x):
                return x % 2 == 0

            print(list(filter(even, [2, 3, 4])))
		</code></pre>
        <div class="terminal">
            [2, 4]
        </div>
	</section>

    <section>
		<h2>Réduction</h2>
		<ul>
			<li>Produire une valeur à partir de la liste entière</li>
			<li>Le résultat est une valeur</li>
		</ul>
		<pre><code class="lang-python">
            def sum(L):
                res = 0
                for elem in L:
                    res = res + elem
                return res
		</code></pre>
		<ul>
			<li>Seuls la valeur initiale de <code>res</code> et le contenu du <code>for</code> sont spécifiques.</li>
		</ul>
	</section>

    <section>
		<h2>Fonction <code>reduce()</code></h2>
		<ul>
			<li>Factorisons la partie commune:</li>
		</ul>
		<pre><code class="lang-python">
            from functools import reduce

            def add(a, b):
                return a + b

            print(reduce(add, [2, 3, 4], 0))
		</code></pre>
        <div class="terminal">
            9
        </div>
	</section>

    <section>
        <h1>Division de problème</h1>
    </section>

    <section>
        <h2>Division de problème</h2>
        <ul>
            <li>Les <strong>longs</strong> programmes ne sont pas toujours faciles à comprendre.</li>
        </ul>
        <pre><code class="lang-python">
            n=1
            nb = 10
            while nb > 0:
                divisors = 0
                d=1
                while d <= n:
                    if n % d == 0:
                        divisors += 1
                    d += 1
                if divisors == 2:
                    print(n)
                    nb -= 1
                n += 1
        </code></pre>
    </section>

    <section>
        <h2>Divisions de problèmes</h2>
        <ul>
            <li>Il faut <strong>diviser</strong> le problème en sous-problèmes <strong>simples</strong> à comprendre.</li>
            <li>Afficher les 10 premiers nombres premiers.
                <ul>
                    <li>tester si un nombre est diviseur d'un autre.</li>
                    <li>tester si un nombre est premier.</li>
                    <li>afficher les n premiers nombres premiers.</li>
                </ul>
            </li>
        </ul>
    </section>

    <section>
        <h2>Divisions de problèmes</h2>
        <ul>
            <li>Tester si un nombre est diviseur d'un autre.</li>
        </ul>
        <pre><code class="lang-python">
            def isDivisor(d, n):
                return n % d == 0
        </code></pre>
    </section>

    <section>
        <h2>Divisions de problèmes</h2>
        <ul>
            <li>Tester si un nombre est premier.</li>
        </ul>
        <pre><code class="lang-python">
            # n strictement supérieur à 1 (1 n'est jamais premier)
            def isPrime(n):
                d=2
                while not isDivisor(d, n):
                    d += 1
                return d == n
        </code></pre>
    </section>

    <section>
        <h2>Divisions de problèmes</h2>
        <ul>
            <li>Afficher les <code>n</code> premiers nombres premiers.</li>
        </ul>
        <pre><code class="lang-python">
            def printPrimes(nb):
                n=2
                while nb > 0:
                    if isPrime(n):
                        print(n)
                        nb -= 1
                    n += 1
        </code></pre>
    </section>

    <section>
        <h2>Divisions de problèmes</h2>
        <ul>
            <li>Programme complet.</li>
        </ul>
        <pre><code class="lang-python">
            def isDivisor(d, n):
                return n % d == 0

            # n strictement supérieur à 1 (1 n'est jamais premier)
            def isPrime(n):
                d=2
                while not isDivisor(d, n):
                    d += 1
                return d == n
            
            def printPrimes(nb):
                n=2
                while nb > 0:
                    if isPrime(n):
                        print(n)
                        nb -= 1
                    n += 1
            
            printPrimes(10)
        </code></pre>
    </section>

    <section>
        <h1>Fonctions récursives</h1>
    </section>

    <section>
        <h2>Fonctions récursives</h2>
        <ul>
            <li>Une fonction peut <strong>s'appeler elle-même</strong>.
                <ul>
                    <li>Exemple : la factorielle.
                        <pre><code class="lang-python">
                            def fact(n):
                                result = 1
                                while n > 0:
                                    result *= n
                                    n -= 1
                                return result
                        </code></pre>
                    </li>
                    <li>En récursif :
                        <pre><code class="lang-python">
                            def fact(n):
                                if n == 1:
                                    return 1
                                return fact(n - 1) * n
                        </code></pre>
                    </li>
                </ul>
            </li>
        </ul>
    </section>

    <section>
        <h2>Fonctions récursives</h2>
        <ul>
            <li>Attention aux <strong>boucles</strong> d'appels <strong>infinies</strong> !</li>
            <li>Il faut toujours prévoir un cas de base.</li>
        </ul>
        <pre><code class="lang-python">
            def fact(n):
                if n == 1:               # cas de base
                    return 1
                return fact(n - 1) * n   # cas récursif
        </code></pre>
    </section>

    <section class="deck-only">
        <p class='center big'>N'oubliez pas de faire vos <a href="exercices4.zip">exercices</a> !</p>
        <p class='center'>A remettre sur claco</p>
     </section>
</body>
</html>
